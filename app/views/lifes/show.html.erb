<div>
    <div class="my-3 font-weight-bold"><%= "id: #{@life.id}の個別ページ" %></div>
    <!--現在ログインしているユーザーと訪問している詳細ページのidを比較して、同一ユーザーだった場合 && 人生登録してない場合は人生登録のフォームを表示-->
    <% if @life.id == @current_user && @life.name == nil %>
        <%= form_with model: @life, :url => {:action => :update }, local: true do |f| %>
            <div class="form-group">
                <label>Name</label>
                <%= f.text_field :name, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Year</label>
                <%= f.number_field :year, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Month</label>
                <%= f.number_field :month, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Date</label>
                <%= f.number_field :date, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Introduce</label>
                <%= f.text_area :introduce, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Image</label>
                <%= f.file_field :image, class: "form-control" %>
            </div>
            <div class="text-center">
                <%= f.submit "Save", class: "btn btn-primary" %>
            </div>
        <% end %>
    <!--その他で編集画面を出す必要がない時は普通に表示させる-->
    <% elsif @life.id == @current_user && @life.name != nil %>
        <div class="d-flex w-100 align-items-center">
            <div class="flex-fill">
                <img src="/user_images/<%= @life.id %>.jpg">
            </div>
            <div class="flex-fill">
                <h2>
                    <%= @life.name %>
                </h2>
                <div class="d-flex">
                    <p>
                        <%= @life.year %>年
                    </p>
                     <p>
                        <%= @life.month %>月
                    </p>
                     <p>
                        <%= @life.date %>日
                    </p>
                </div>
                <p>
                    <%= @life.introduce %>
                </p>
            </div>
        </div>
        <!--現在ログインしているユーザーと訪問している詳細ページのidを比較-->
        <% if @life.id == @current_user %>
            <%= link_to "edit", edit_life_path, class: "btn btn-primary" %>
        <% end %>
        <!--イベント部分-->
        <div>
            <h3>Events</h3>
            <table class="table table-striped">
                <% if @life.contents.any? %>
                    <thead class="thead-light">
                        <tr>
                            <td>Year</td>
                            <td>Month</td>
                            <td>Date</td>
                            <td>Event</td>
                            <td></td>
                            <td></td>
                        </tr>
                    </thead>
                    <tbody>
                        <% @life.contents.each do |content| %>
                        <tr>
                            <td>
                                <%= content.year %>
                            </td>
                            <td>
                                <%= content.month %>
                            </td>
                            <td>
                                <%= content.date %>
                            </td>
                            <td>
                                <%= content.event %>
                            </td>
                            <td>
                                <%= link_to "Edit", edit_life_content_path(@life, content), class: "btn btn-primary" %>
                            </td>
                            <td>
                                <%= link_to "Delete", life_content_path(@life, content), method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-primary" %>
                            </td>
                        </tr>
                        <% end %>
                    </tbody>
                <% else %>
                    <p>No Events</p>
                <% end %>
            </table>
        </div>
        <!--イベント部分 ここまで-->
        <%= form_with model: [@life, @content], local: true do |f| %>
            <%= f.hidden_field :life_id, { value: @life.id } %>
            <div class="form-group">
                <label>Year</label>
                <%= f.number_field :year, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Month</label>
                <%= f.number_field :month, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Date</label>
                <%= f.number_field :date, class: "form-control" %>
            </div>
            <div class="form-group">
                <label>Event</label>
                <%= f.text_area :event, class: "form-control" %>
            </div>
            <div class="text-center">
                <%= f.submit "Post!", class: "btn btn-primary" %>
            </div>
        <% end %>
    <!--その他で編集画面を出す必要がない時は普通に表示させる-->
    <% else %>
        <div class="d-flex w-100 align-items-center">
            <div class="flex-fill">
                <img src="/user_images/<%= @life.id %>.jpg">
            </div>
            <div class="flex-fill">
                <h2>
                    <%= @life.name %>
                </h2>
                <div class="d-flex">
                    <p>
                        <%= @life.year %>年
                    </p>
                     <p>
                        <%= @life.month %>月
                    </p>
                     <p>
                        <%= @life.date %>日
                    </p>
                </div>
                <p>
                    <%= @life.introduce %>
                </p>
            </div>
            <!--イベント部分-->
            <div>
                <h3>Events</h3>
                <table class="table table-striped">
                    <% if @life.contents.any? %>
                        <thead class="thead-light">
                            <tr>
                                <td>Year</td>
                                <td>Month</td>
                                <td>Date</td>
                                <td>Event</td>
                            </tr>
                        </thead>
                        <tbody>
                            <% @life.contents.each do |content| %>
                            <tr>
                                <td>
                                    <%= content.year %>
                                </td>
                                <td>
                                    <%= content.month %>
                                </td>
                                <td>
                                    <%= content.date %>
                                </td>
                                <td>
                                    <%= content.event %>
                                </td>
                            </tr>
                            <% end %>
                        </tbody>
                    <% else %>
                        <p>No Events</p>
                    <% end %>
                </table>
            </div>
        </div>
    <% end %>
</div>
